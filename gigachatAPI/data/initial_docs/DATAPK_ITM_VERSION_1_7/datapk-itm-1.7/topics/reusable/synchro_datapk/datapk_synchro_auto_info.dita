<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="ReusableComponent_nv3_j4k_syb">
    <title></title>
    <taskbody id="taskbody_pv3_j4k_syb"><prereq>Для синхронизации на локальном сервере используется порт 443/<ph conref="../protocol_names/TCP.dita#ReusableComponent_s2p_3gl_4yb/ph_t2p_3gl_4yb"/>.</prereq><context><note type="tip">Рекомендуется использовать регулярную синхронизацию с небольшим интервалом во время первичной настройки <abbreviated-form keyref="monitoring_object"/> и с бо́льшим интервалом во время эксплуатации, если есть вероятность появления новых <abbreviated-form keyref="monitoring_object"/> в сети.</note><p>Для настройки автоматической синхронизации по расписанию:</p></context><steps><step><cmd>Остановите работу контейнеров:</cmd><info><codeblock>docker-compose down</codeblock></info></step><step><cmd>Откройте <codeph conref="../filepath/env.dita#ReusableComponent_osh_smr_hrb/codeph_rsh_smr_hrb"/> файл для настройки регулярной синхронизации:</cmd><info><codeblock>vi /opt/itm-k/.env</codeblock></info></step><step><cmd>Найдите и отредактируйте следующие переменные:</cmd><substeps><substep><cmd><cmdname keyref="datapk_host"/> — IP-адрес DATAPK.</cmd><stepxmp>для IP-адреса 192.168.1.1 значение переменной будет <cmdname keyref="datapk_host"/>=https://192.168.1.1.</stepxmp></substep><substep><cmd><cmdname keyref="datapk_port"/> — номер порта для подключения.</cmd></substep><substep><cmd><cmdname keyref="datapk_version"/> — версия API DATAPK. Совпадает с версией DATAPK. Уточнить значение можно в веб-интерфейсе DATAPK в разделе Настройка и мониторинг → Основные, в поле «Информация об изготовителе».</cmd><info><table frame="all" rowsep="1" colsep="1" id="table_jcy_ds2_vwb"><title>Соотношение версии DATAPK и значения переменной <cmdname keyref="datapk_version"/></title><tgroup cols="2"><colspec colname="c1" colnum="1" colwidth="1*"/><colspec colname="c2" colnum="2" colwidth="1*"/><thead><row><entry>Версия DATAPK</entry><entry>Значение переменной <cmdname keyref="datapk_version"/></entry></row></thead><tbody><row><entry>1.19.0.2-fstec</entry><entry>19_fstec</entry></row><row><entry>1.19.X.X</entry><entry>19</entry></row><row><entry>1.18.X.X</entry><entry>18</entry></row><row><entry>1.17.X.X</entry><entry>17</entry></row><row><entry>1.16.X.X</entry><entry>16</entry></row></tbody></tgroup></table></info></substep><substep><cmd><cmdname keyref="datapk_user"/> — имя пользователя в веб-интерфейсе DATAPK.</cmd></substep><substep><cmd><cmdname keyref="datapk_password"/> — пароль пользователя в веб-интерфейсе DATAPK.</cmd></substep><substep><cmd><cmdname keyref="zabbix_user"/> — имя пользователя <ph outputclass="udvpdf"><term keyref="udv_itm_k"/></ph><ph outputclass="onlypdf"><term keyref="datapk_itm_k"/></ph><ph outputclass="html"><term keyref="datapk_itm_k"/></ph> для синхронизации с DATAPK. Подробнее про создание пользователя см. в разделе <xref href="../../requirements/safe_installation/datapk_synchro/create_user_synchro_datapk.dita"/>. </cmd></substep><substep><cmd><cmdname keyref="zabbix_password"/> — пароль пользователя <ph outputclass="udvpdf"><term keyref="udv_itm_k"/></ph><ph outputclass="onlypdf"><term keyref="datapk_itm_k"/></ph><ph outputclass="html"><term keyref="datapk_itm_k"/></ph> для синхронизации с DATAPK.</cmd></substep><substep><cmd><cmdname keyref="synchronization_delay_seconds"/> — период синхронизации в секундах. Значение по умолчанию — 3600 секунд.</cmd><info><note>При пусконаладке для ускорения синхронизации рекомендуем использовать команду, которая одноразово запускает синхронизацию:<codeblock>docker-compose run synchronizer python3 -m synchronizer.synchronization</codeblock></note></info></substep><substep><cmd><cmdname keyref="synchronization_enabled"/> — включение или отключение синхронизации с DATAPK. Для включения синхронизации задайте значение <codeph>true</codeph>. </cmd></substep></substeps></step><step><cmd>Cохраните файл и выйдите из режима редактирования: <codeph>:wq</codeph>.</cmd></step><step><cmd>Запустите работу контейнеров командой:</cmd><info><codeblock>docker-compose up -d</codeblock></info></step><step><cmd>Убедитесь, что синхронизатор включен. Для этого:</cmd><substeps><substep><cmd>Просмотрите список запущенных контейнеров:</cmd><info><codeblock>docker ps</codeblock></info></substep><substep><cmd>Если в списке не обнаружится контейнера synchronizer, включите его:</cmd><info><codeblock>docker start synchronizer</codeblock></info></substep></substeps></step><step conref="../notes/datapk_synchro_approve.dita#ReusableComponent_y4z_gfk_vrb/step_z4z_gfk_vrb"><cmd/></step></steps></taskbody>
</task>
