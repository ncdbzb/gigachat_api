<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="ReusableComponent_hnv_dyf_1xb">
    <title></title>
    <taskbody id="taskbody_jnv_dyf_1xb"><context><p>Для настройки шифрования между сервером <ph outputclass="udvpdf"><term keyref="udv_itm_k"/></ph><ph outputclass="onlypdf"><term keyref="datapk_itm_k"/></ph><ph outputclass="html"><term keyref="datapk_itm_k"/></ph> и агентами (на примере <abbreviated-form keyref="monitoring_object"/> с <abbreviated-form keyref="OS"/> Linux):</p></context><steps><step><cmd>Перейдите в режим командной строки <abbreviated-form keyref="monitoring_object"/>.</cmd></step><step conref="create_encryption_key.dita#ReusableComponent_inc_q13_bsb/step_jnc_q13_bsb"><cmd/></step><step conref="encryption_change_user_key.dita#ReusableComponent_oql_1b3_bsb/step_pql_1b3_bsb"><cmd/></step><step><cmd>Перейдите в режим редактирования файла конфигурации агента:</cmd><stepxmp>Для файла конфигурации по умолчанию <codeph>/etc/zabbix/zabbix_agentd.conf</codeph> это можно сделать командой: <codeblock>vi /etc/zabbix/zabbix_agentd.conf</codeblock></stepxmp></step><step><cmd>Измените значения следующих переменных:</cmd><info><codeblock><cmdname keyref="tlsconnect"/>=psk
<cmdname keyref="tlsaccept"/>=psk
<cmdname keyref="tlspskfile"/>=/etc/zabbix/key.psk
<cmdname keyref="tlspskidentity"/>=[Название_идентификатора]</codeblock></info><stepxmp><codeblock><cmdname keyref="tlspskidentity"/>=TESTPSK</codeblock></stepxmp></step><step conref="exit_wq.dita#ReusableComponent_vrx_hh3_zrb/step_wrx_hh3_zrb"><cmd/></step><step><cmd>Перезапустите сервис zabbix-proxy для применения новой конфигурации агента: </cmd><info><codeblock>systemctl restart zabbix-agent</codeblock></info></step><step><cmd>Получите содержимое ключа безопасности:</cmd><info><codeblock>cat /etc/zabbix/key.psk</codeblock></info><stepxmp>В результате выполнения команды в консоли отображается ключ: <codeblock>e87e4daf1568e43e52e7596a3570e1b4114127cb51fe72c8eacadd510b7560b5</codeblock></stepxmp></step><step><cmd>Скопируйте строку ключа безопасности в буфер обмена.</cmd></step><step><cmd>В веб-интерфейсе <ph outputclass="udvpdf"><term keyref="udv_itm_k"/></ph><ph outputclass="onlypdf"><term keyref="datapk_itm_k"/></ph><ph outputclass="html"><term keyref="datapk_itm_k"/></ph> перейдите на страницу <cite keyref="configuration"/> → <cite keyref="hosts_configuration"/>.</cmd></step><step><cmd>Выберите узел сети и кликните на его имени.</cmd><stepresult>Откроется страница настройки агента.</stepresult></step><step><cmd>Перейдите на вкладку «Шифрование».</cmd><info><fig><title>Вкладка «Шифрование» на странице настроек агента</title><image href="../../../images/ITM-K_encryption/proxy_encryption.png"/></fig></info></step><step><cmd>Выберите режим «Подключения к узлу сети» — «PSK».</cmd></step><step><cmd>Для соединения с узлом сети установите чекбокс рядом с режимом «PSK».</cmd></step><step><cmd>Отмените выбор остальных чекбоксов.</cmd></step><step><cmd>В поле «Идентификатор PSK» введите название идентификатора, указанное ранее в переменной <cmdname keyref="tlspskidentity"/>.</cmd></step><step><cmd>В поле «PSK» введите скопированное ранее значение ключа безопасности.</cmd><info><fig><title>Настройки прокси</title><image href="../../../images/ITM-K_encryption/proxy_agent2.png"/></fig></info></step><step><cmd>Нажмите на кнопку «Обновить» для применения настроек. </cmd></step></steps></taskbody>
</task>
